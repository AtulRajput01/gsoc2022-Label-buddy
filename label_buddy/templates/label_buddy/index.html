{% extends "base.html" %}

{% load static %}

{% block head_files%}
    {{ block.super }}
    <link href="{% static 'css/index.css' %}" rel="stylesheet" type="text/css">
{% endblock %}

{% block title %} Label Buddy {% endblock %}

{% block content %}
	{% if user.is_authenticated%}
		{% if projects %}
			<h1 style="text-align:center">Projects you are involved</h1>
			<div class="my-custom-scrollbar table-wrapper-scroll-y ">
				<!--Table-->
				<table class="table table-bordered table-striped">
				<!--Table head-->
				<thead>
					<tr>
					<th>#</th>
					<th>Title</th>
					<th>Creation date</th>
					<th>Queues are public</th>
					<th title="Number of tasks"><i title="Number of tasks" class="fa fa-tasks" aria-hidden="true"></i></th>
					<th title="Number of annotations"><i title="Number of annotations" class="fa fa-paint-brush" aria-hidden="true"></i></th>
					<th>Annotator</th>
					<th>Reviewer</th>
					<th>Managers</th>
					</tr>
				</thead>
				<!--Table head-->

				<!--Table body-->
				<tbody>
					{% for project in projects %}
						<tr>
							<td>{{ project.id }}</td>
							<td>
							<a class="my-link" href="{% url 'project_page' project.id %}">
								{% if project.logo %}
								<img style="margin-right: 10%;" src="{{ project.logo.url }}" width="27" height="27" title="You" class="rounded-circle">
								{% else %}
								<img style="margin-right: 10%;" src="{% static '/images/project_logo_not_found.png' %}" width="27" height="27" title="{{ project.title }}" class="rounded-circle">
								{% endif %}
								{{ project.title }}</a>
							</td>
							<td>{{ project.created_at|date:"d-m-y"}}</td>
							{% if project.users_can_see_other_queues%}
								<td><i style="color:green" class="fa fa-thumbs-up" aria-hidden="true"></i></td>
							{% else %}
								<td><i style="color:red" class="fa fa-thumbs-down" aria-hidden="true"></i></td>
							{% endif %}
							<td><b>{{ tasks_count|get_item:project.id }}</b></td>
							<td><b>{{ annotations_count|get_item:project.id }}</b></td>

							{% comment %}
							{% if user in project.managers.all %}
								<td><i style="color:green" class="fa fa-thumbs-up" aria-hidden="true"></i></td>
							{% else %}
								<td><i style="color:red" class="fa fa-thumbs-down" aria-hidden="true"></i></td>
							{% endif %}
							{% endcomment %}

							{% if user in project.annotators.all %}
								<td><i style="color:green" class="fa fa-thumbs-up" aria-hidden="true"></i></td>
							{% else %}
								<td><i style="color:red" class="fa fa-thumbs-down" aria-hidden="true"></i></td>
							{% endif %}

							{% if user in project.reviewers.all %}
								<td><i style="color:green" class="fa fa-thumbs-up" aria-hidden="true"></i></td>
							{% else %}
								<td><i style="color:red" class="fa fa-thumbs-down" aria-hidden="true"></i></td>
								<td>
									{% for obj in project.managers.all %}
										{% if obj.avatar %}
											{% if obj == user %}
												<img style="border: 2px solid #74deed;" src="{{ obj.avatar.url }}" width="27" height="27" title="You" class="rounded-circle">
											{% else %}
												<img src="{{ obj.avatar.url }}" width="25" height="25" title="{{ obj.username }}" class="rounded-circle">
											{% endif %}
										{% else %}
											{% if obj == user%}
												<img style="border: 2px solid #74deed;" src="{% static '/images/user/user.jpg' %}" width="27" height="27" title="You" class="rounded-circle">
											{% else %}
												<img src="{% static '/images/user/user.jpg' %}" width="25" height="25" title="{{ obj.username }}" class="rounded-circle">
											{% endif %}
										{% endif %}
									{% endfor %}
								</td>
							{% endif %}
						</tr>
						
					{% endfor %}
				</tbody>
				<!--Table body-->
			</table>
			{% else %}
				<h1 style="text-align:center">No projects for you yet</h1>
			{% endif %}
		{% else %}
			<div class="center-screen">
				<h1>Welcome to Label Buddy</h1>
				<p>Please <a class="my-link" href="/accounts/login">sign in</a> to continue
				</p>
			</div>
		{% endif %}
		
{% endblock %}